<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EIDAS OpenID4VP - V√©rification de Pr√©sentations</title>
  <link rel="stylesheet" href="verification.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <h1>üîê EIDAS Credential Verification</h1>
        <p>Cin√©matique OpenID4VP avec QR Code</p>
      </div>
      <nav class="nav">
        <a href="/" class="nav-link">‚Üê Retour √† l'accueil</a>
      </nav>
    </header>

    <main class="main-content">
      <!-- Section 1: Configuration de la v√©rification -->
      <section class="section configuration-section">
        <div class="section-header">
          <h2>üìã Configurer la V√©rification</h2>
          <p>Choisissez le type de credential √† v√©rifier</p>
        </div>

        <div class="form-container">
          <!-- S√©lection du type -->
          <div class="form-group">
            <label for="credentialSelector">Type de Credential:</label>
            <select id="credentialSelector" onchange="updateCredentialDescription()">
              <option value="custom_credential">Custom Credential</option>
              <option value="eu.europa.ec.eudi.pid.1">EIDAS PID (Person ID)</option>
            </select>
          </div>

          <!-- Description et requirements -->
          <div class="form-group">
            <label>Description:</label>
            <p id="credentialDescription" class="credential-info"></p>
          </div>

          <div class="form-group">
            <label>Requirements:</label>
            <pre id="credentialRequirements" class="requirements-box"></pre>
          </div>

          <!-- Bouton d'initiation -->
          <div class="form-group button-group">
            <button class="btn btn-primary" onclick="initiateVerification()">
              Initier la v√©rification ‚Üí
            </button>
          </div>
        </div>
      </section>

      <!-- Section 2: V√©rification en cours -->
      <section class="section verification-section" id="verificationSection" style="display: none;">
        <div class="section-header">
          <h2>üîç Demande de V√©rification</h2>
          <p>Scannez le QR code avec votre wallet</p>
        </div>

        <div class="verification-container">
          <!-- QR Code -->
          <div class="qr-container">
            <img id="qrCodeVerification" src="" alt="QR Code" class="qr-code">
            <p class="qr-instruction">Scannez avec votre wallet EIDAS</p>
          </div>

          <!-- Informations -->
          <div class="verification-info">
            <div class="info-item">
              <span class="info-label">Session ID:</span>
              <span id="verificationSessionId" class="info-value">-</span>
            </div>
            <div class="info-item">
              <span class="info-label">Type:</span>
              <span id="verificationCredentialType" class="info-value">-</span>
            </div>
            <div class="info-item">
              <span class="info-label">V√©rificateur:</span>
              <span id="verificationVerifier" class="info-value">-</span>
            </div>
            <div class="info-item">
              <span class="info-label">Expire dans:</span>
              <span id="verificationExpiry" class="info-value">-</span>
            </div>
            <div class="info-item status-item">
              <span class="info-label">Statut:</span>
              <span id="verificationStatusBadge" class="status-badge">‚è≥ En attente...</span>
            </div>
          </div>
        </div>

        <!-- URL compl√®te -->
        <div class="url-container">
          <label>URL du Wallet:</label>
          <input type="text" id="verificationWalletUrl" readonly class="url-input">
        </div>

        <!-- Bouton de r√©initialisation -->
        <div class="form-group button-group">
          <button class="btn btn-secondary" onclick="resetVerification()">
            ‚Üê Retour
          </button>
        </div>
      </section>

      <!-- Section 3: R√©sultats de la v√©rification -->
      <section class="section results-section" id="presentationResults" style="display: none;">
        <div class="section-header">
          <h2>‚úÖ R√©sultats de la V√©rification</h2>
          <p>Pr√©sentation re√ßue et v√©rifi√©e</p>
        </div>

        <div class="results-container">
          <!-- Statut -->
          <div class="status-container">
            <span id="presentationVerificationStatus" class="status-badge">-</span>
          </div>

          <!-- D√©tails -->
          <div class="details-section">
            <h3>D√©tails du Credential</h3>
            <div id="presentationDetails" class="details-content"></div>
          </div>

          <!-- Payload -->
          <div class="payload-section">
            <h3>Donn√©es du Credential</h3>
            <pre id="presentationPayload" class="payload-box"></pre>
          </div>

          <!-- VP Token -->
          <div class="token-section">
            <h3>VP Token (JWT)</h3>
            <textarea id="presentationVpToken" class="token-box" readonly></textarea>
          </div>

          <!-- Boutons -->
          <div class="form-group button-group">
            <button class="btn btn-secondary" onclick="resetVerification()">
              ‚Üê Nouvelle v√©rification
            </button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="verification.js"></script>
</body>
</html>
